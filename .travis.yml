#https://github.com/levy9527/blog/issues/1
#https://juejin.im/post/6844904045857996813
language: node_js

node_js:
  - lts/*

cache: yarn

notifications:      # é‚®ç®±é€šçŸ¥
  email: 664127999@qq.com

#æŒ‡å®šæ„å»ºåˆ†æ”¯
branches:
  only:
    - master

before_install:
  - git pull
  - echo "Checkout ğŸ›ï¸"

install: 
  - yarn
  - echo "Install ğŸ”§"

script:
  - echo "Codecov ğŸ”§"
  - yarn codecov
  - echo "Build ğŸ”§"
  - yarn build

#æŠŠ dist æ–‡ä»¶æ¨é€åˆ° github gh-page åˆ†æ”¯ä¸‹
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GH_TOKEN
  keep_history: true
  target_branch: gh-page
  committer_from_gh: true
  on:
    branch: master
  local_dir: build

after_deploy: 
  - echo "Deploy ğŸš€"

after_success:
  - echo 'successfully done'